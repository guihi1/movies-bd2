<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/media-details.css" />
    <title><%= pageTitle %></title>
  </head>

  <body>
    <%- include('../partials/navbar') %>
    <div class="container">
      <h1><%= serie.nome %></h1>
      <div class="media-details">
        <p>
          <strong>Ano:</strong>
          <%= serie.ano_de_inicio %>
          <% if (serie.ano_de_fim) { %>
            - <%= serie.ano_de_fim %>
          <% } else { %>
            - Presente
          <% } %>
        </p>
        <p>
          <strong>Nota Média:</strong> 
          <%= parseFloat(serie.nota).toFixed(1) %> / 10
        </p>
        <p>
          <strong>Temporadas:</strong> 
          <%= serie.numero_de_temporadas %>
        </p>
        <p>
          <strong>Faturamento:</strong> 
          $ <%= serie.faturamento.toLocaleString('pt-BR') %>
        </p>
        <h3>Sinopse</h3>
        <p><%= serie.sinopse %></p>
      </div>

      <div class="temporadas-container">
        <h3 class="temporada-titulo">Temporadas</h3>
        
        <% if (temporadas && temporadas.length > 0) { %>
          <% temporadas.forEach((temp, index) => { %>
            <div class="temporada-card">
              <div class="temporada-header">
                Temporada <%= index + 1 %> 
                (<%= temp.ano %>) - <%= temp.numero_de_episodios %> Episódios
              </div>
              
              <ul class="episodios-lista">
                <% if (temp.episodios && temp.episodios.length > 0) { %>
                  <% temp.episodios.forEach(ep => { %>
                    <li class="episodio-item">
                      <div class="episodio-info">
                        <span class="episodio-titulo">
                          S<%= index + 1 %>E<%= ep.numero_episodio %>: <%= ep.titulo %>
                        </span>
                        <span class="episodio-duracao">
                          Duração: <%= ep.tempo_de_duracao %> min
                        </span>
                      </div>
                      <span class="episodio-nota">
                        Nota: <%= parseFloat(ep.nota).toFixed(1) %>
                      </span>
                    </li>
                  <% }); %>
                <% } else { %>
                    <li class="episodio-item">Episódios não disponíveis.</li>
                <% } %>
              </ul>
            </div>
          <% }); %>
        <% } else { %>
          <p>Informações de temporadas e episódios não disponíveis.</p>
        <% } %>
      </div>
      
      <h3 class="elenco-titulo">Elenco</h3>
      <div class="elenco-container">
        <% if (atores && atores.length > 0) { %> 
          <% atores.forEach(ator => { %>
            <div class="ator-card">
              <a href="/actors/<%= ator.pessoa_id %>" class="ator-link"> 
                <span class="ator-nome"> <%= ator.nome_ator %> </span>
              </a>
              <span class="ator-personagem"> <%= ator.personagem %> </span>
            </div>
          <% }); %> 
        <% } else { %>
          <p>Informações de elenco não disponíveis.</p>
        <% } %>
      </div>

      <a href="/" class="back-link">← Voltar para a lista</a>
    </div>
  </body>
</html>